{"version":3,"sources":["reorder.service.ts"],"names":[],"mappings":"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","file":"reorder.service.js","sourcesContent":["import {Http} from '@angular/http';\nimport {Observable} from 'rxjs/Observable';\nimport 'rxjs/add/operator/map';\nimport {Injectable} from '@angular/core';\nimport { Headers, RequestOptions } from '@angular/http';\nimport {OrderService} from './order.service';\nimport {RequestService} from './http.service';\n\n\n@Injectable()\nexport class ReorderService {\n\n  pastOrders = [];\n\n  pastOrdersClient = [];\n\n  addOns : AddOn;\n\n  apiItem: ConfigAPI;\n\n  cartItem: ConfigCART;\n\n  constructor(private _httpService: RequestService,\n    public orderService : OrderService){\n\n  }\n\n  getOrders(phone){\n\n    this._httpService.getOrders(phone)\n    .subscribe(data => this.orgData(data));\n\n    this._httpService.getOrdersClient(phone)\n    .subscribe(data => this.orgDataClient(data));\n\n  }\n\n  orgData(data){\n    let length = data.length;\n\n    for(var i = 0; i < length; i++ ){\n      let pastOrder = [];\n\n      let items = data[i].items.length;\n      let col = [];\n      for(var a = 0; a < items; a++ ){\n        let oItem = [];\n\n        let tops = data[i].items[a].additionals.length;\n        let toppings = [];\n        for(var b = 0; b < tops; b++ ){\n          toppings.push(data[i].items[a].additionals[b]);\n        }\n\n        oItem['item_id'] = data[i].items[a].item_id;\n        oItem['additionals'] = toppings;\n\n        col.push(oItem);\n      }\n\n      pastOrder['order_id'] = data[i].order_id;\n      pastOrder['items'] = col;\n\n\n\n      this.pastOrders.push(pastOrder);\n\n    }\n\n\n  }\n\n  orgDataClient(data){\n    console.log(data);\n    let length = data.length;\n\n    for(var i = 0; i < length; i++ ){\n      let pastOrder = [];\n\n      let items = data[i].items.length;\n      let col = [];\n      for(var a = 0; a < items; a++ ){\n        let oItem = [];\n\n        let tops = data[i].items[a].additionals.length;\n        let toppings = [];\n        for(var b = 0; b < tops; b++ ){\n          toppings.push(data[i].items[a].additionals[b]);\n        }\n\n        oItem['name'] = data[i].items[a].name;\n        oItem['price'] = data[i].items[a].price;\n        oItem['additionals'] = toppings;\n\n        col.push(oItem);\n      }\n\n      pastOrder['order_id'] = data[i].order_id;\n      pastOrder['items'] = col;\n      this.pastOrdersClient.push(pastOrder);\n\n    }\n  }\n\n  retrieveOrderState(orderIndex){\n    let total = this.pastOrders[orderIndex].items.length;\n\n    for(var itemIndex = 0; itemIndex < total; itemIndex++){\n        let index = itemIndex;\n        this._httpService.getSpecificAddOns(this.pastOrders[orderIndex].items[itemIndex].additionals)\n        .subscribe(data => this.applyOrder(data, orderIndex, index));\n    }\n\n    //clear past orders to reduce clutter\n    this.pastOrders = [];\n    this.pastOrdersClient = [];\n\n  }\n\n  applyOrder(data, orderIndex, itemIndex){\n    let length = data.length;\n    this.orderService.apiAdditionals = [];\n    this.orderService.cartAdditionals = [];\n    this.orderService.cartPrices = [];\n    this.orderService.cartPrices.push(this.pastOrdersClient[orderIndex].items[itemIndex].price);\n    for(var i = 0; i < length; i++){\n\n      this.orderService.apiAdditionals.push(data[i].id);\n      this.orderService.cartAdditionals.push(data[i].name);\n      this.orderService.cartPrices.push(data[i].price);\n      this.orderService.total = this.orderService.cartPrices.reduce(function(total,num){return total+num});\n\n    }\n\n    this.apiItem = {\n      item_id: this.pastOrders[orderIndex].items[itemIndex].item_id,\n      additionals: this.orderService.apiAdditionals\n    }\n\n    this.cartItem = {\n      name : this.pastOrdersClient[orderIndex].items[itemIndex].name,\n      additionals : this.orderService.cartAdditionals,\n      prices: this.orderService.cartPrices,\n      total: this.orderService.total,\n    }\n\n    this.orderService.addToOrder(this.apiItem);\n    this.orderService.addToCart(this.cartItem);\n    this.orderService.itemPrices.push(this.orderService.total);\n\n  }\n\n}\n\nexport interface AddOn {\n  id: number,\n  name: string,\n  price: number\n}\n\nexport interface pastOrder {\n  order_id:number,\n  orderItem: pOrderItem[]\n}\n\nexport interface pOrderItem {\n  item_id: number,\n  additionals: number[]\n}\n\nexport interface ConfigAPI{\n  item_id: any,\n  additionals: any,\n}\n\nexport interface ConfigCART {\n  name: string,\n  additionals: any,\n  prices: any,\n  total: number,\n}\n"],"sourceRoot":"/source/"}